########################################
# Major Flavor Events                  #
########################################

namespace = flavor_spa

# The Iberian Wedding
country_event = {
	id = flavor_spa.3716
	title = "flavor_spa.EVTNAME3716"
	desc = "flavor_spa.EVTDESC3716"
	picture = DIPLOMACY_eventPicture

	major = yes
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_3716 }
		NOT = { is_year = 1444 }
		AND = {
			tag = CAS
			NOT = { exists = SPA }
		}
		is_subject = no
		ARA = {
			exists = yes
			ai = yes
			was_player = no
			is_subject = no
			is_neighbor_of = ROOT
		}
		NOT = { war_with = ARA }
		OR = {
			AND = {
				is_female = yes
				ARA = { is_female = no }
			}
			AND = {
				is_female = no
				ARA = { is_female = yes }
			}
			ARA = {
				has_regency = yes
			}
		}
	}

	mean_time_to_happen = {
		months = 120
		modifier = {
			factor = 0.1
			ARA = { has_regency = no }
		}
	}
	
	immediate = {
		set_country_flag = SPA_had_event_3716
	}
	
	option = {		# Let us bind their Dynasty to ours
		name = "flavor_spa.EVTOPTA3716"
		ai_chance = { factor = 90 }
		create_union = ARA
		add_opinion = {
			who = ARA
			modifier = spa_iberian_wedding
		}
		ARA = {
			add_opinion = {
				who = ROOT
				modifier = spa_iberian_wedding
			}
		}
		random_owned_province = {
			limit = {
				is_capital = no
			}
			spawn_rebels = {
				type = noble_rebels
				size = 3
			}
		}
		every_known_country = {
			limit = {
				marriage_with = ARA
			}
			add_opinion = {
				who = ROOT
				modifier = spa_iberian_wedding_negative
			}
		}
	}
	option = {		# No let us marry a local talent instead
		name = "flavor_spa.EVTOPTB3716"
		ai_chance = { factor = 10 }
		add_stability = 1
		ARA = {
			add_opinion = {
				who = ROOT
				modifier = spa_declined_iberian_wedding
			}
		}
	}
}

# Torquemada and the Expulsion of the Moors
country_event = {
	id = flavor_spa.3150
	title = "flavor_spa.EVTNAME3150"
	desc = "flavor_spa.EVTDESC3150"
	picture = ADVISOR_eventPicture
	
	fire_only_once = yes

	trigger = {
		is_year = 1450
		NOT = { is_year = 1550 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		religion = catholic
		is_at_war = no
		any_owned_province = {
			region = iberian_peninsula
			religion_group = muslim
		}
	}

	mean_time_to_happen = {
		months = 2000
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = spa_holy_inquisition
		}
	}

	option = {		# Let us make a clean sweep for the Glory of God
		name = "flavor_spa.EVTOPTA3150"
		ai_chance = {
			factor = 60
			modifier = {
				factor = 0
				NOT = { stability = 1 }
			}
		}
		add_stability = -3
		if = {
			limit = {
				NOT = { advisor_exists = 620 }
			}
			define_advisor = {
				type = theologian 
				name = "Tomás de Torquemada"
				location = 215 # Castilla La Vieja 
				skill = 3
			}
		}
		every_owned_province = {
			limit = {
				region = iberian_peninsula
				religion_group = muslim
			}
			change_religion = catholic
			add_base_tax = -1
			add_province_modifier = {
				name = forced_conversion
				duration = 3650
			}
		}	
		random_country = {
			limit = {
				religion_group = muslim
				any_owned_province = {
					sea_zone = {
						any_neighbor_province = {
							owned_by = ROOT
						}
					}
				}
			}
			country_event = {  id = flavor_spa.3151 days = 10 tooltip = "flavor_spa.EVTTOOLTIP3150" }
		}
		set_country_flag = torquemada_expelled
		add_reform_desire = 0.02

	}
	option = {		# Let us be rid of those we cannot trust
		name = "flavor_spa.EVTOPTB3150"
		add_reform_desire = 0.01
		ai_chance = {
			factor = 30
			modifier = {
				factor = 0
				NOT = { stability = -2 }
			}
		}
		add_stability = -1
		random_owned_province = {
			limit = {
				region = iberian_peninsula
				religion_group = muslim
			}
			change_religion = catholic
			add_base_tax = -1
			add_province_modifier = {
				name = forced_conversion
				duration = 3650
			}
		}
		random_country = {
			limit = {
				religion_group = muslim
				any_owned_province = {
					sea_zone = {
						any_neighbor_province = {
							owned_by = ROOT
						}
					}
				}
			}
			country_event = {  id = flavor_spa.3151 days = 10 tooltip = "flavor_spa.EVTTOOLTIP3150" }
		}
		set_country_flag = torquemada_expelled
	}
	option = {		# Toleration is key to the nation's prosperity
		name = "flavor_spa.EVTOPTC3150"
		add_reform_desire = -0.01

		ai_chance = { factor = 10 }
		add_stability = 1
		add_ruler_modifier = {
			name = religious_tolerance
		}
	}
}

# Expulsion of the Moors
country_event = {
	id = flavor_spa.3151
	title = "flavor_spa.EVTNAME3151"
	desc = "flavor_spa.EVTDESC3151"
	picture = ECONOMY_eventPicture

	is_triggered_only = yes

	option = {		# They are a welcome addition
		name = "flavor_spa.EVTOPTA3151"
		ai_chance = { factor = 90 }
		random_owned_province = {
			add_base_tax = 1
		}
	}
	option = {		# No, close our borders to them
		name = "flavor_spa.EVTOPTB3151"
		ai_chance = { factor = 10 }
	}
}

# Christopher Columbus
country_event = {
	id = flavor_spa.1
	title = "flavor_spa.EVTNAME1"
	desc = "flavor_spa.EVTDESC1"
	picture = SHIP_SAILING_eventPicture

	is_triggered_only = yes
	
	trigger = {
		NOT = {
			north_america = {
				has_discovered = ROOT
			}
		}
		NOT = {
			south_america = {
				has_discovered = ROOT
			}
		}
		NOT = {
			any_known_country = {
				north_america = {
					has_discovered = PREV
				}
			}
		}
		NOT = {
			any_known_country = {
				south_america = {
					has_discovered = PREV
				}
			}
		}
	}

	option = {		# Reject his proposal
		name = "flavor_spa.EVTOPTA1"
		ai_chance = { factor = 10 }
	}
	option = {		# Hire Columbus
		name = "flavor_spa.EVTOPTB1"
		ai_chance = { factor = 90 }
		add_years_of_income = -0.25
		define_explorer = {
			name = "Cristóbal Colón"
			fire = 2
			shock = 2
			manuever = 6
			siege = 0
		}
	}
}

# Discovery of the New World!
country_event = {
	id = flavor_spa.1005
	title = "flavor_spa.EVTNAME1005"
	desc = "flavor_spa.EVTDESC1005"
	picture = COLONIZATION_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_1005 }
		NOT = { is_year = 1500 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		OR = {
			north_america = {
				has_discovered = ROOT
			}
			south_america = {
				has_discovered = ROOT
			}
		}
	}

	mean_time_to_happen = {
		months = 1
	}
	
	immediate = {
		set_country_flag = SPA_had_event_1005
	}

	option = {		# Now so have we!
		name = "flavor_spa.EVTOPTA1005"
		add_prestige = 50
	}
}

# Ignacio de Loyola
country_event = {
	id = flavor_spa.1011
	title = "flavor_spa.EVTNAME1011"
	desc = "flavor_spa.EVTDESC1011"
	picture = ADVISOR_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_1011 }
		is_year = 1521
		NOT = { is_year = 1556 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		religion = catholic
		is_at_war = no
		NOT = { advisor_exists = 638 }
	}

	mean_time_to_happen = {
		months = 300
	}
	
	immediate = {
		set_country_flag = SPA_had_event_1011
	}

	option = {		# An Excellent Minister!
		name = "EXCELLENTMINISTER"
		add_adm_power = 25
		define_advisor = {
			type = theologian 
			name = "Ignacio de Loyola"
			skill = 3
		}
	}
}

# The Quest for the New World
country_event = {
	id = flavor_spa.3152
	title = "flavor_spa.EVTNAME3152"
	desc = "flavor_spa.EVTDESC3152"
	picture = EXPLORERS_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3152 }
		is_year = 1450
		NOT = { is_year = 1500 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		religion = catholic
		is_at_war = no
		army_tradition = 30
		OR = {
			north_america = {
				has_discovered = ROOT
			}
			south_america = {
				has_discovered = ROOT
			}
		}
		NOT = {
			any_owned_province = {
				region = iberian_peninsula
				religion_group = muslim
			}
		}
		NOT = {
			iberian_peninsula = {
				owner = { NOT = { religion_group = christian } }
			}
		}
		NOT = {
			iberian_peninsula = {
				owner = { tag = GRA }
			}
		}
	}

	mean_time_to_happen = {
		months = 1000
		modifier = {
			factor = 0.95
			num_of_colonies = 2
		}
		modifier = {
			factor = 0.95
			num_of_colonies = 3
		}
		modifier = {
			factor = 0.95
			num_of_colonies = 4
		}
		modifier = {
			factor = 0.75
			num_of_colonies = 5
		}
		modifier = {
			factor = 0.5
			num_of_colonies = 10
		}
		modifier = {
			factor = 0.95
			army_tradition = 40
		}
		modifier = {
			factor = 0.95
			army_tradition = 50
		}
		modifier = {
			factor = 0.95
			army_tradition = 60
		}
		modifier = {
			factor = 0.75
			army_tradition = 70
		}
		modifier = {
			factor = 0.75
			north_america = {
				has_discovered = ROOT
			}
			south_america = {
				has_discovered = ROOT
			}
		}
	}
	
	immediate = {
		set_country_flag = SPA_had_event_3152
	}

	option = {		# A New Reconquista! We need Conquistadors
		name = "flavor_spa.EVTOPTA3152"
		ai_chance = { factor = 45 }
		add_stability = 1
		if = {
			limit = {
				NOT = { army_tradition = 75 }
			}
			create_conquistador = 5
		}
		if = {
			limit = {
				army_tradition = 75
			}
			create_conquistador = 10
		}
	}
	option = {		# A New Reconquista! We need Explorers
		name = "flavor_spa.EVTOPTB3152"
		ai_chance = { factor = 45 }
		add_stability = 1
		if = {
			limit = {
				NOT = { army_tradition = 75 }
			}
			create_explorer = 5
		}
		if = {
			limit = {
				army_tradition = 75
			}
			create_explorer = 10
		}
	}
	option = {		# These men are better needed at home
		name = "flavor_spa.EVTOPTC3152"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 20
				NOT = { manpower_percentage = 0.2 }
			}
		}
		add_stability = -1
		if = {
			limit = {
				NOT = { army_tradition = 75 }
			}
			add_manpower = 4
		}
		if = {
			limit = {
				army_tradition = 75
			}
			add_manpower = 8
		}
	}
}

# Crusade against Oran
country_event = {
	id = flavor_spa.1000
	title = "flavor_spa.EVTNAME1000"
	desc = "flavor_spa.EVTDESC1000"
	picture = BATTLE_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_1000 }
		is_year = 1500
		NOT = { is_year = 1550 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		NOT = {
			iberian_peninsula = {
				religion_group = muslim
			}
		}
		337 = {
			owner = {
				religion_group = muslim
				NOT = { alliance_with = ROOT }
				NOT = { is_subject_of = ROOT }
			}
		}
	}

	mean_time_to_happen = {
		months = 1000
	}
	
	immediate = {
		set_country_flag = SPA_had_event_1000
	}

	option = {		# Expansion in North Africa seems prosperous
		name = "flavor_spa.EVTOPTA1000"
		337 = {
			add_claim = ROOT
		}
	}
}

# Laws of Burgos
country_event = {
	id = flavor_spa.1001
	title = "flavor_spa.EVTNAME1001"
	desc = "flavor_spa.EVTDESC1001"
	picture = REFORM_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_1001 }
		is_year = 1500
		NOT = { is_year = 1600 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		OR = {
			north_america = {
				owned_by = ROOT
				revolt_risk = 3
			}
			south_america = {
				owned_by = ROOT
				revolt_risk = 3
			}
		}
	}

	mean_time_to_happen = {
		months = 1000
		modifier = {
			factor = 0.95
			OR = {
				north_america = {
					owned_by = ROOT
					revolt_risk = 5
				}
				south_america = {
					owned_by = ROOT
					revolt_risk = 5
				}
			}
		}
		modifier = {
			factor = 0.85
			OR = {
				north_america = {
					owned_by = ROOT
					revolt_risk = 10
				}
				south_america = {
					owned_by = ROOT
					revolt_risk = 10
				}
			}
		}
		modifier = {
			factor = 0.75
			OR = {
				north_america = {
					owned_by = ROOT
					revolt_risk = 15
				}
				south_america = {
					owned_by = ROOT
					revolt_risk = 15
				}
			}
		}
		modifier = {
			factor = 0.65
			OR = {
				north_america = {
					owned_by = ROOT
					revolt_risk = 20
				}
				south_america = {
					owned_by = ROOT
					revolt_risk = 20
				}
			}
		}
	}
	
	immediate = {
		set_country_flag = SPA_had_event_1001
	}

	option = {		# Enforce these laws!
		name = "flavor_spa.EVTOPTA1001"
		ai_chance = { factor = 75 }
		every_owned_province = {
			limit = {
				continent = north_america
			}
			add_province_modifier = {
				name = laws_of_the_burgos
				duration = 3650
			}
		}
		every_owned_province = {
			limit = {
				continent = south_america
			}
			add_province_modifier = {
				name = laws_of_the_burgos
				duration = 3650
			}
		}
	}
	option = {		# We rule by the right of Conqueror!
		name = "flavor_spa.EVTOPTB1001"
		ai_chance = { factor = 25 }
		set_country_flag = no_laws_of_the_burgos
		every_owned_province = {
			limit = {
				continent = north_america
				revolt_risk = 3
			}
			add_province_modifier = {
				name = native_unrest
				duration = 3650
			}
		}
		every_owned_province = {
			limit = {
				continent = south_america
				revolt_risk = 3
			}
			add_province_modifier = {
				name = native_unrest
				duration = 3650
			}
		}
	}
}

# The New Laws
country_event = {
	id = flavor_spa.1002
	title = "flavor_spa.EVTNAME1002"
	desc = "flavor_spa.EVTDESC1002"
	picture = REFORM_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_1002 }
		is_year = 1500
		NOT = { is_year = 1600 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		had_country_flag = { flag = SPA_had_event_1001 days = 4015 }
		OR = {
			north_america = {
				owned_by = ROOT
				revolt_risk = 3
			}
			south_america = {
				owned_by = ROOT
				revolt_risk = 3
			}
		}
	}

	mean_time_to_happen = {
		months = 1000
		modifier = {
			factor = 0.75
			has_country_flag = no_laws_of_the_burgos
		}
		modifier = {
			factor = 0.95
			OR = {
				north_america = {
					owned_by = ROOT
					revolt_risk = 5
				}
				south_america = {
					owned_by = ROOT
					revolt_risk = 5
				}
			}
		}
		modifier = {
			factor = 0.85
			OR = {
				north_america = {
					owned_by = ROOT
					revolt_risk = 10
				}
				south_america = {
					owned_by = ROOT
					revolt_risk = 10
				}
			}
		}
		modifier = {
			factor = 0.75
			OR = {
				north_america = {
					owned_by = ROOT
					revolt_risk = 15
				}
				south_america = {
					owned_by = ROOT
					revolt_risk = 15
				}
			}
		}
		modifier = {
			factor = 0.65
			OR = {
				north_america = {
					owned_by = ROOT
					revolt_risk = 20
				}
				south_america = {
					owned_by = ROOT
					revolt_risk = 20
				}
			}
		}
	}
	
	immediate = {
		set_country_flag = SPA_had_event_1002
	}

	option = {		# Enforce these laws!
		name = "flavor_spa.EVTOPTA1002"
		ai_chance = { factor = 75 }
		every_owned_province = {
			limit = {
				continent = north_america
			}
			add_province_modifier = {
				name = the_new_laws
				duration = 3650
			}
		}
		every_owned_province = {
			limit = {
				continent = south_america
			}
			add_province_modifier = {
				name = the_new_laws
				duration = 3650
			}
		}
	}
	option = {		# Leave these decisions to the colonies
		name = "flavor_spa.EVTOPTB1002"
		ai_chance = { factor = 25 }
		every_owned_province = {
			limit = {
				continent = north_america
				revolt_risk = 3
			}
			add_province_modifier = {
				name = severe_native_unrest
				duration = 3650
			}
		}
		every_owned_province = {
			limit = {
				continent = south_america
				revolt_risk = 3
			}
			add_province_modifier = {
				name = severe_native_unrest
				duration = 3650
			}
		}
	}
}

# Casa de Contratación
country_event = {
	id = flavor_spa.1003
	title = "flavor_spa.EVTNAME1003"
	desc = "flavor_spa.EVTDESC1003"
	picture = COLONIZATION_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_1003 }
		is_year = 1500
		NOT = { is_year = 1600 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		num_of_colonies = 3
	}

	mean_time_to_happen = {
		months = 2000
		modifier = {
			factor = 0.95
			num_of_colonies = 5
		}
		modifier = {
			factor = 0.95
			num_of_colonies = 7
		}
		modifier = {
			factor = 0.95
			num_of_colonies = 9
		}
		modifier = {
			factor = 0.95
			num_of_colonies = 11
		}
		modifier = {
			factor = 0.95
			num_of_colonies = 13
		}
		modifier = {
			factor = 0.95
			num_of_colonies = 15
		}
	}
	
	immediate = {
		set_country_flag = SPA_had_event_1003
	}

	option = {		# We should establish it
		name = "flavor_spa.EVTOPTA1003"
		ai_chance = { factor = 90 }
		add_years_of_income = -0.25
		add_country_modifier = {
			name = casa_de_contratacion
			duration = -1
		}
	}
	option = {		# Colonial affairs is not for the crown
		name = "flavor_spa.EVTOPTB1003"
		ai_chance = { factor = 10 }
	}
}

# The Sun Never Sets
country_event = {
	id = flavor_spa.1004
	title = "flavor_spa.EVTNAME1004"
	desc = "flavor_spa.EVTDESC1004"
	picture = COURT_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_1004 }
		is_year = 1500
		NOT = { is_year = 1600 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		europe = {
			owned_by = ROOT
		}
		OR = {
			north_america = {
				owned_by = ROOT
			}
			any_subject_country = {
				is_colonial_nation = yes
				north_america = {
					owned_by = PREV
				}
			}
		}
		OR = {
			south_america = {
				owned_by = ROOT
			}
			any_subject_country = {
				is_colonial_nation = yes
				south_america = {
					owned_by = PREV
				}
			}
		}
		africa = {
			owned_by = ROOT
		}
		asia = {
			owned_by = ROOT
		}
	}

	mean_time_to_happen = {
		months = 2000
		modifier = {
			factor = 0.95
			num_of_owned_provinces_with = {
				value = 3
				continent = north_america
			}
		}
		modifier = {
			factor = 0.95
			num_of_owned_provinces_with = {
				value = 3
				continent = south_america
			}
		}
		modifier = {
			factor = 0.95
			num_of_owned_provinces_with = {
				value = 3
				continent = africa
			}
		}
		modifier = {
			factor = 0.95
			num_of_owned_provinces_with = {
				value = 3
				continent = asia
			}
		}
		modifier = {
			factor = 0.95
			num_of_owned_provinces_with = {
				value = 5
				continent = north_america
			}
		}
		modifier = {
			factor = 0.95
			num_of_owned_provinces_with = {
				value = 5
				continent = south_america
			}
		}
		modifier = {
			factor = 0.95
			num_of_owned_provinces_with = {
				value = 5
				continent = africa
			}
		}
		modifier = {
			factor = 0.95
			num_of_owned_provinces_with = {
				value = 5
				continent = asia
			}
		}
		modifier = {
			factor = 0.95
			oceania = {
				owned_by = ROOT
			}
		}
	}
	
	immediate = {
		set_country_flag = SPA_had_event_1004
	}

	option = {		# We truly rule the world!
		name = "flavor_spa.EVTOPTA1004"
		add_prestige = 50
	}
}

# The Trade Center of Sevilla
country_event = {
	id = flavor_spa.3153
	title = "flavor_spa.EVTNAME3153"
	desc = "flavor_spa.EVTDESC3153"
	picture = MERCHANTS_TALKING_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3153 }
		is_year = 1500
		NOT = { is_year = 1600 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		is_at_war = no
		owns = 224	# Andalucia
		num_of_colonial_subjects = 1
		OR = {
			north_america = {
				has_discovered = ROOT
			}
			south_america = {
				has_discovered = ROOT
			}
		}
	}

	mean_time_to_happen = {
		months = 2000
		modifier = {
			factor = 0.95
			num_of_colonies = 2
		}
		modifier = {
			factor = 0.95
			num_of_colonies = 3
		}
		modifier = {
			factor = 0.95
			num_of_colonies = 4
		}
		modifier = {
			factor = 0.95
			num_of_colonies = 5
		}
		modifier = {
			factor = 0.75
			num_of_colonies = 10
		}
		modifier = {
			factor = 0.85
			north_america = {
				has_discovered = ROOT
			}
			south_america = {
				has_discovered = ROOT
			}
		}
	}
	
	immediate = {
		set_country_flag = SPA_had_event_3153
	}

	option = {		# We now have control of our Oversea Trade
		name = "flavor_spa.EVTOPTA3153"
		224 = {
			add_province_modifier = {
				name = port_to_the_new_world
				duration = -1
			}
		}
	}
}

# The Fuggers
country_event = {
	id = flavor_spa.3154
	title = "flavor_spa.EVTNAME3154"
	desc = "flavor_spa.EVTDESC3154"
	picture = COURT_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3154 }
		is_year = 1500
		NOT = { is_year = 1600 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		is_at_war = no
	}

	mean_time_to_happen = {
		months = 2000
	}
	
	immediate = {
		set_country_flag = SPA_had_event_3154
	}

	option = {		# Let the Fuggers run our Finances
		name = "flavor_spa.EVTOPTA3154"
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0
				NOT = { stability = -1 }
			}
		}
		add_stability = -1
		add_ruler_modifier = {
			name = the_fuggers
		}
	}
	option = {		# Turn the Fuggers offer down
		name = "flavor_spa.EVTOPTB3154"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				stability = 1
			}
		}
		add_stability = 1
	}
}

# The Communeros
country_event = {
	id = flavor_spa.3155
	title = "flavor_spa.EVTNAME3155"
	desc = "flavor_spa.EVTDESC3155"
	picture = ANGRY_MOB_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3155 }
		is_year = 1500
		NOT = { is_year = 1600 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		is_at_war = no
	}

	mean_time_to_happen = {
		months = 2000
		modifier = {
			factor = 0.95
			NOT = { stability = 1 }
		}
		modifier = {
			factor = 0.95
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.95
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.95
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 3
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 5
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 10
		}
		modifier = {
			factor = 0.85
			war_exhaustion = 15
		}
		modifier = {
			factor = 0.75
			war_exhaustion = 20
		}
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = SPA_had_event_3155
			random_owned_province = {
				limit = {
					is_capital = no
					is_core = ROOT
				}
				set_province_flag = communeros_revolt
			}
			random_owned_province = {
				limit = {
					is_capital = no
					is_core = ROOT
					NOT = { has_province_flag = communeros_revolt }
				}
				set_province_flag = communeros_revolt
			}
		}
	}

	option = {		# Crush the Rebellion
		name = "flavor_spa.EVTOPTA3155"
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0
				NOT = { manpower_percentage = 0.1 }
			}
			modifier = {
				factor = 0
				NOT = { stability = 0 }
			}
		}
		add_stability = -1
		every_owned_province = {
			limit = {
				has_province_flag = communeros_revolt
			}
			spawn_rebels = {
				type = anti_tax_rebels
				size = 3
			}
			clr_province_flag = communeros_revolt
		}
	}
	option = {		# Give concessions to the Peasantry
		name = "flavor_spa.EVTOPTB3155"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				manpower_percentage = 0.99
			}
			modifier = {
				factor = 0
				stability = 3
			}
		}
		add_years_of_income = -0.1
		add_ruler_modifier = {
			name = concessions_to_the_peasantry
		}
		hidden_effect = {
			every_owned_province = {
				clr_province_flag = communeros_revolt
			}
		}
	}
}

# The Knights of St. John of Jerusalem
country_event = {
	id = flavor_spa.3156	
	title = "flavor_spa.EVTNAME3156"
	desc = "flavor_spa.EVTDESC3156"
	picture = RELIGION_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3156 }
		is_year = 1500
		NOT = { is_year = 1600 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		is_at_war = no
		owns = 126	# Malta
		religion = catholic
		NOT = { exists = KNI }
	}

	mean_time_to_happen = {
		months = 2000
	}
	
	immediate = {
		set_country_flag = SPA_had_event_3156
	}

	option = {		# Give Malta to the Knights of St:John
		name = "flavor_spa.EVTOPTA3156"
		ai_chance = { factor = 50 }
		add_stability = 1
		126 = {
			remove_core = ROOT
			cede_province = KNI
		}
		KNI = {
			add_opinion = {
				who = ROOT
				modifier = spa_ceded_malta
			}
		}
		PAP = {
			add_opinion = {
				who = ROOT
				modifier = spa_ceded_malta_pap
			}
		}
	}
	option = {		# Give Malta and Tripolitania to the Knights of St:John
		name = "flavor_spa.EVTOPTB3156"
		ai_chance = { factor = 50 }
		
		add_stability = 1
		126 = {
			remove_core = ROOT
			cede_province = KNI
		}
		if  = {
			limit = { owns = 354 }
			354 = {
				remove_core = ROOT
				cede_province = KNI
			}
		}

		KNI = {
			add_opinion = {
				who = ROOT
				modifier = spa_ceded_malta
			}
		}
		PAP = {
			add_opinion = {
				who = ROOT
				modifier = spa_ceded_malta_pap
			}
		}
	}
	option = {		# Don't give them anything
		name = "flavor_spa.EVTOPTC3156"
		ai_chance = { factor = 0 }
		PAP = {
			add_opinion = {
				who = ROOT
				modifier = spa_refused_ceding_malta
			}
		}
	}
}

# State Bankruptcy
country_event = {
	id = flavor_spa.3158	
	title = "flavor_spa.EVTNAME3158"
	desc = "flavor_spa.EVTDESC3158"
	picture = BANKRUPTCY_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3158 }
		NOT = { is_year = 1590 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		is_bankrupt = yes
	}

	mean_time_to_happen = {
		months = 120
	}
	
	immediate = {
		set_country_flag = SPA_had_event_3158
	}

	option = {		# Do we ever learn from history?
		name = "flavor_spa.EVTOPTA3158"
	}
}

# The Expulsion of the Moriscos
country_event = {
	id = flavor_spa.3160	
	title = "flavor_spa.EVTNAME3160"
	desc = "flavor_spa.EVTDESC3160"
	picture = ANGRY_MOB_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3160 }
		is_year = 1600
		NOT = { is_year = 1650 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		religion = catholic
		any_owned_province = {
			region = iberian_peninsula
			OR = {
				religion_group = muslim
				AND = {
					culture = andalucian
					owner = {
						NOT = { primary_culture  = andalucian }
					}
				}
			}
		}
	}

	mean_time_to_happen = {
		months = 2000
	}
	
	immediate = {
		set_country_flag = SPA_had_event_3160
	}

	option = {		# Force them to become Good Catholic Spaniards
		name = "flavor_spa.EVTOPTA3160"
		ai_chance = { factor = 90 }
		add_stability = 2
		every_owned_province = {
			limit = {
				region = iberian_peninsula
				OR = {
					religion_group = muslim
					AND = {
						culture = andalucian
						owner = {
							NOT = { primary_culture = andalucian }
						}
					}
				}
			}
			if = {
				limit = {
					religion_group = muslim
				}
				change_religion = catholic
			}
			if = {
				limit = {
					AND = {
						culture = andalucian
						owner = {
							NOT = { primary_culture = andalucian }
						}
					}
				}
				change_culture = capital
			}
			add_base_tax = -2
			add_province_modifier = {
				name = forced_conversion
				duration = 3650
			}
		}
		random_country = {
			limit = {
				religion_group = muslim
				any_owned_province = {
					sea_zone = {
						any_neighbor_province = {
							owned_by = ROOT
						}
					}
				}
			}
			country_event = {  id = flavor_spa.3161 days = 10 tooltip = "flavor_spa.EVTTOOLTIP3160" }
		}
	}
	option = {		# Let them be as they are needed for the economy
		name = "flavor_spa.EVTOPTB3160"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				NOT = { stability = 2 }
			}
		}
		add_stability = -2
	}
}

# Expulsion of the Moriscos
country_event = {
	id = flavor_spa.3161
	title = "flavor_spa.EVTNAME3161"
	desc = "flavor_spa.EVTDESC3161"
	picture = ECONOMY_eventPicture

	is_triggered_only = yes

	option = {		# They are a welcome addition
		name = "flavor_spa.EVTOPTA3161"
		ai_chance = { factor = 90 }
		random_owned_province = {
			add_base_tax = 1
		}
	}
	option = {		# No, close our borders to them
		name = "flavor_spa.EVTOPTB3161"
		ai_chance = { factor = 10 }
	}
}

# Baltasar de Zuniga
country_event = {
	id = flavor_spa.3710
	title = "flavor_spa.EVTNAME3710"
	desc = "flavor_spa.EVTDESC3710"
	picture = ADVISOR_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_3710 }
		is_year = 1591
		NOT = { is_year = 1622 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
	}

	mean_time_to_happen = {
		months = 300
	}

	immediate = {
		set_country_flag = SPA_had_event_3710
	}

	option = {			# An Excellent Minister!
		name = "EXCELLENTMINISTER"
		add_adm_power = 25
		define_advisor = {
			type = statesman
			name = "Baltasar de Zuniga"
			skill = 3
		}
	}
}

# Olivares
country_event = {
	id = flavor_spa.3711
	title = "flavor_spa.EVTNAME3711"
	desc = "flavor_spa.EVTDESC3711"
	picture = ADVISOR_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_3711 }
		is_year = 1617
		NOT = { is_year = 1645 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		NOT = { advisor_exists = 675 }
	}

	mean_time_to_happen = {
		months = 300
	}

	immediate = {
		set_country_flag = SPA_had_event_3711
	}

	option = {			# An Excellent Minister!
		name = "EXCELLENTMINISTER"
		add_adm_power = 25
		define_advisor = {
			type = statesman
			name = "Conde-Duque Olivares"
			skill = 3
		}
	}
}

# The Portuguese Crown
country_event = {
	id = flavor_spa.3162	
	title = "flavor_spa.EVTNAME3162"
	desc = "flavor_spa.EVTDESC3162"
	picture = COURT_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3162 }
		is_year = 1550
		NOT = { is_year = 1600 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		marriage_with = POR
		POR = {
			exists = yes
			ai = yes
			was_player = no
			has_regency = yes
			religion = ROOT
			has_opinion = { who = ROOT value = 100 }
		}
	}

	mean_time_to_happen = {
		months = 2000
		modifier = {
			factor = 0.95
			has_opinion = { who = ROOT value = 125 }
		}
		modifier = {
			factor = 0.95
			has_opinion = { who = ROOT value = 150 }
		}
		modifier = {
			factor = 0.95
			has_opinion = { who = ROOT value = 175 }
		}
		modifier = {
			factor = 0.95
			has_opinion = { who = ROOT value = 200 }
		}
	}
	
	immediate = {
		set_country_flag = SPA_had_event_3162
	}

	option = {		# One King, One Kingdom
		name = "flavor_spa.EVTOPTA3162"
		ai_chance = { factor = 75 }
		add_stability = 1
		POR = {
			every_owned_province = {
				limit = {
					is_core = POR
					NOT = { is_core = ROOT }
				}
				add_province_modifier = {
					name = foreign_ruler
					duration = 3650
				}
			}
		}
		inherit = POR
	}
	option = {		# One King, Two Kingdoms
		name = "flavor_spa.EVTOPTB3162"
		ai_chance = { factor = 25 }
		add_stability = -1
		vassalize = POR
	}
	option = {		# The extra burden is not worth it
		name = "flavor_spa.EVTOPTC3162"
		ai_chance = { factor = 0 }
	}
}

# The Portuguese Crown
country_event = {
	id = flavor_spa.3163	
	title = "flavor_spa.EVTNAME3163"
	desc = "flavor_spa.EVTDESC3163"
	picture = COURT_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3163 }
		is_year = 1600
		NOT = { is_year = 1650 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		marriage_with = POR
		POR = {
			exists = yes
			ai = yes
			was_player = no
			has_regency = yes
			religion = ROOT
			has_opinion = { who = ROOT value = 100 }
		}
	}

	mean_time_to_happen = {
		months = 2000
		modifier = {
			factor = 0.95
			has_opinion = { who = ROOT value = 125 }
		}
		modifier = {
			factor = 0.95
			has_opinion = { who = ROOT value = 150 }
		}
		modifier = {
			factor = 0.95
			has_opinion = { who = ROOT value = 175 }
		}
		modifier = {
			factor = 0.95
			has_opinion = { who = ROOT value = 200 }
		}
	}
	
	immediate = {
		set_country_flag = SPA_had_event_3163
	}

	option = {		# One King, One Kingdom
		name = "flavor_spa.EVTOPTA3163"
		ai_chance = { factor = 75 }
		add_stability = 1
		POR = {
			every_owned_province = {
				limit = {
					is_core = POR
					NOT = { is_core = ROOT }
				}
				add_province_modifier = {
					name = foreign_ruler
					duration = 3650
				}
			}
		}
		inherit = POR
	}
	option = {		# One King, Two Kingdoms
		name = "flavor_spa.EVTOPTB3163"
		ai_chance = { factor = 25 }
		add_stability = -1
		vassalize = POR
	}
	option = {		# The extra burden is not worth it
		name = "flavor_spa.EVTOPTC3163"
		ai_chance = { factor = 0 }
	}
}

# State Bankruptcy
country_event = {
	id = flavor_spa.3164	
	title = "flavor_spa.EVTNAME3164"
	desc = "flavor_spa.EVTDESC3164"
	picture = BANKRUPTCY_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3164 }
		is_year = 1590
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		is_bankrupt = yes
	}

	mean_time_to_happen = {
		months = 120
	}
	
	immediate = {
		set_country_flag = SPA_had_event_3164
	}

	option = {		# Do we ever learn from history?
		name = "flavor_spa.EVTOPT3164"
	}
}

# Epidemic Plague
country_event = {
	id = flavor_spa.3165	
	title = "flavor_spa.EVTNAME3165"
	desc = "flavor_spa.EVTDESC3165"
	picture = PLAGUE_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3165 }
		is_year = 1550
		NOT = { is_year = 1650 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		is_at_war = no
		num_of_cities = 4
		iberian_peninsula = {
			owned_by = ROOT
		}
	}

	mean_time_to_happen = {
		months = 2000
		modifier = {
			factor = 0.95
			war_exhaustion = 3
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 5
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 10
		}
	}
	
	immediate = {
		set_country_flag = SPA_had_event_3165
	}

	option = {		# We will recover
		name = "flavor_spa.EVTOPTA3165"
		if = {
			limit = {
				NOT = { num_of_cities = 10 }
			}
			random_owned_province = {
				limit = {
					region = iberian_peninsula
					base_tax = 2
				}
				add_base_tax = -1
			}
		}
		if = {
			limit = {
				num_of_cities = 10
			}
			random_owned_province = {
				limit = {
					region = iberian_peninsula
					base_tax = 2
				}
				add_base_tax = -1
				set_province_flag = epidemic_plague
			}
			random_owned_province = {
				limit = {
					NOT = { has_province_flag = epidemic_plague }
					region = iberian_peninsula
					base_tax = 2
				}
				add_base_tax = -1
			}
		}
		hidden_effect = {
			every_owned_province = {
				clr_province_flag = epidemic_plague
			}
		}
	}
}

# The Iberian Revolts
country_event = {
	id = flavor_spa.3169
	title = "flavor_spa.EVTNAME3169"
	desc = "flavor_spa.EVTDESC3169"
	picture = ANGRY_MOB_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3169 }
		is_year = 1600
		NOT = { is_year = 1700 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		num_of_cities = 4
		NOT = { primary_culture = catalan }
		any_owned_province = {
			culture = catalan
		}
	}

	mean_time_to_happen = {
		months = 2000
		modifier = {
			factor = 0.95
			NOT = { stability = 1 }
		}
		modifier = {
			factor = 0.95
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.95
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.95
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.95
			is_at_war = yes
		}
		modifier = {
			factor = 0.95
			war_with = FRA
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 3
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 5
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 10
		}
		modifier = {
			factor = 0.85
			war_exhaustion = 15
		}
		modifier = {
			factor = 0.75
			war_exhaustion = 20
		}
	}
	
	immediate = {
		set_country_flag = SPA_had_event_3169
	}

	option = {		# Put it down!
		name = "flavor_spa.EVTOPTA3169"
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0
				NOT = { stability = -1 }
			}
		}
		add_stability = -1
		if = {
			limit = {
				any_owned_province = {
					culture = catalan
					any_neighbor_province = {
						owned_by = FRA
					}
				}
			}
			every_owned_province = {
				limit = {
					culture = catalan
					NOT = {
						any_neighbor_province = {
							culture = ROOT
						}
					}
				}
				spawn_rebels = {
					type = nationalist_rebels
					size = 2
					friend = FRA
				}
				set_province_flag = catalan_revolt
			}
			every_owned_province = {
				limit = {
					culture = catalan
					NOT = { has_province_flag = catalan_revolt }
				}
				spawn_rebels = {
					type = nationalist_rebels
					size = 1
					friend = FRA
				}
			}
		}
		if = {
			limit = {
				NOT = {
					any_owned_province = {
						culture = catalan
						any_neighbor_province = {
							owned_by = FRA
						}
					}
				}
			}
			every_owned_province = {
				limit = {
					culture = catalan
					NOT = {
						any_neighbor_province = {
							culture = ROOT
						}
					}
				}
				spawn_rebels = {
					type = nationalist_rebels
					size = 2
				}
				set_province_flag = catalan_revolt
			}
			every_owned_province = {
				limit = {
					culture = catalan
					NOT = { has_province_flag = catalan_revolt }
				}
				spawn_rebels = {
					type = nationalist_rebels
					size = 1
				}
			}
		}
		hidden_effect = {
			every_owned_province = {
				clr_province_flag = catalan_revolt
			}
		}
	}
	option = {		# Appease them!
		name = "flavor_spa.EVTOPTB3169"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				stability = 1
			}
		}
		add_stability = 1
		every_owned_province = {
			limit = {
				culture = catalan
			}
			add_province_modifier = {
				name = local_autonomy
				duration = 3650
			}
		}
	}
}

# National revolt in Portugal
country_event = {
	id = flavor_spa.3168	
	title = "flavor_spa.EVTNAME3168"
	desc = "flavor_spa.EVTDESC3168"
	picture = DIPLOMACY_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3168 }
		is_year = 1600
		NOT = { is_year = 1700 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		num_of_cities = 4
		NOT = { primary_culture = portugese }
		any_owned_province = {
			culture = portugese
		}
	}

	mean_time_to_happen = {
		months = 2000
		modifier = {
			factor = 0.95
			NOT = { stability = 1 }
		}
		modifier = {
			factor = 0.95
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.95
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.95
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.95
			is_at_war = yes
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 3
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 5
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 10
		}
		modifier = {
			factor = 0.85
			war_exhaustion = 15
		}
		modifier = {
			factor = 0.75
			war_exhaustion = 20
		}
		modifier = {
			factor = 0.85
			has_country_flag = SPA_had_event_3169
		}
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = SPA_had_event_3168
			every_owned_province = {
				limit = {
					culture = portugese
					NOT = {
						any_neighbor_province = {
							culture = ROOT
						}
					}
				}
				set_province_flag = portuguese_revolt_2
			}
			every_owned_province = {
				limit = {
					culture = portugese
					NOT = { has_province_flag = portuguese_revolt_2 }
				}
				set_province_flag = portuguese_revolt_1
			}
		}
	}

	option = {		# Put it down!
		name = "flavor_spa.EVTOPTA3168"
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0
				NOT = { stability = -1 }
			}
		}
		add_stability = -1
		
		every_owned_province = {
			limit = {
				has_province_flag = portuguese_revolt_2
			}
			spawn_rebels = {
				type = nationalist_rebels
				size = 2
			}
			clr_province_flag = portuguese_revolt_2
		}
		every_owned_province = {
			limit = {
				has_province_flag = portuguese_revolt_1
			}
			spawn_rebels = {
				type = nationalist_rebels
				size = 1
			}
			clr_province_flag = portuguese_revolt_1
		}
	}
	option = {		# Appease them!
		name = "flavor_spa.EVTOPTB3168"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				stability = 1
			}
		}
		add_stability = 1
		every_owned_province = {
			limit = {
				culture = portugese
			}
			add_province_modifier = {
				name = local_autonomy
				duration = 3650
			}
			clr_province_flag = portuguese_revolt_2
			clr_province_flag = portuguese_revolt_1
		}
	}
}

# The Italian Revolts
country_event = {
	id = flavor_spa.3170
	title = "flavor_spa.EVTNAME3170"
	desc = "flavor_spa.EVTDESC3170"
	picture = ANGRY_MOB_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3170 }
		is_year = 1600
		NOT = { is_year = 1700 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		num_of_cities = 4
		any_owned_province = {
			region = italian_region
			NOT = { culture_group = ROOT }
		}
	}

	mean_time_to_happen = {
		months = 2000
		modifier = {
			factor = 0.95
			NOT = { stability = 1 }
		}
		modifier = {
			factor = 0.95
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.95
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.95
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.95
			is_at_war = yes
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 3
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 5
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 10
		}
		modifier = {
			factor = 0.85
			war_exhaustion = 15
		}
		modifier = {
			factor = 0.75
			war_exhaustion = 20
		}
		modifier = {
			factor = 0.85
			has_country_flag = SPA_had_event_3169
		}
	}
	
	immediate = {
		hidden_effect = {
			set_country_flag = SPA_had_event_3170
			if = {
				limit = {
					121 = {		# Napoli
						owned_by = ROOT
						NOT = { culture_group = ROOT }
					}
				}
				121 = {
					set_province_flag = italian_revolt_3
				}
				set_country_flag = italian_revolt_napoli
			}
			if = {
				limit = {
					125 = {		# Palermo
						owned_by = ROOT
						NOT = { culture_group = ROOT }
					}
				}
				125 = {
					set_province_flag = italian_revolt_2
				}
				set_country_flag = italian_revolt_palermo
			}
			if = {
				limit = {
					NOT = { has_country_flag = italian_revolt_napoli }
				}
				random_owned_province = {
					limit = {
						region = italian_region
						NOT = { culture_group = ROOT }
						NOT = { has_province_flag = italian_revolt_2 }
					}
					set_province_flag = italian_revolt_3
				}
			}
			if = {
				limit = {
					NOT = { has_country_flag = italian_revolt_palermo }
				}
				random_owned_province = {
					limit = {
						region = italian_region
						NOT = { culture_group = ROOT }
						NOT = { has_province_flag = italian_revolt_3 }
					}
					set_province_flag = italian_revolt_2
				}
			}
		}
	}

	option = {		# Put it down!
		name = "flavor_spa.EVTOPTA3170"
		ai_chance = {
			factor = 90
			modifier = {
				factor = 0
				NOT = { stability = -1 }
			}
		}
		add_stability = -1
		every_owned_province = {
			limit = {
				has_province_flag = italian_revolt_3
			}
			spawn_rebels = {
				type = nationalist_rebels
				size = 3
			}
			clr_province_flag = italian_revolt_3
		}
		clr_country_flag = italian_revolt_napoli

		every_owned_province = {
			limit = {
				has_province_flag = italian_revolt_2
			}
			spawn_rebels = {
				type = nationalist_rebels
				size = 2
			}
			clr_province_flag = italian_revolt_2
		}
		clr_country_flag = italian_revolt_palermo
	}
	option = {		# Appease them!
		name = "flavor_spa.EVTOPTB3170"
		ai_chance = {
			factor = 10
			modifier = {
				factor = 0
				stability = 1
			}
		}
		add_stability = 1
		every_owned_province = {
			limit = {
				region = italian_region
				NOT = { culture_group = ROOT }
			}
			add_province_modifier = {
				name = local_autonomy
				duration = 3650
			}
			clr_province_flag = italian_revolt_3
			clr_province_flag = italian_revolt_2
		}
		clr_country_flag = italian_revolt_napoli
		clr_country_flag = italian_revolt_palermo
	}
}

# Giulio Alberoni
country_event = {
	id = flavor_spa.3712
	title = "flavor_spa.EVTNAME3712"
	desc = "flavor_spa.EVTDESC3712"
	picture = ADVISOR_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_3712 }
		is_year = 1694
		NOT = { is_year = 1752 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		NOT = { advisor_exists = 690 }
	}

	mean_time_to_happen = {
		months = 300
	}

	immediate = {
		set_country_flag = SPA_had_event_3712
	}
	
	option = {			# An Excellent Minister!
		name = "EXCELLENTMINISTER"
		add_adm_power = 25
		define_advisor = {
			type = statesman
			name = "Giulio Alberoni"
			skill = 1
		}
	}
}

# José Monino
country_event = {
	id = flavor_spa.3094
	title = "flavor_spa.EVTNAME3094"
	desc = "flavor_spa.EVTDESC3094"
	picture = ADVISOR_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_3094 }
		is_year = 1758
		NOT = { is_year = 1808 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
	}

	mean_time_to_happen = {
		months = 300
	}

	immediate = {
		set_country_flag = SPA_had_event_3094
	}
	
	option = {			# An Excellent Minister!
		name = "EXCELLENTMINISTER"
		add_adm_power = 25
		define_advisor = {
			type = statesman
			name = "José Monino"
			skill = 3
		}
	}
}

# The Constitution of 1812
country_event = {
	id = flavor_spa.3095
	title = "flavor_spa.EVTNAME3095"
	desc = "flavor_spa.EVTDESC3095"
	picture = DEBATE_REPUBLICAN_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_3095 }
		is_year = 1800
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
	}

	mean_time_to_happen = {
		months = 300
	}

	immediate = {
		set_country_flag = SPA_had_event_3095
	}

	option = {		# Follow the Cortes
		name = "flavor_spa.EVTOPTA3095"
		ai_chance = { factor = 75 }
		add_country_modifier = {
			name = liberal_constitution
			duration = 3650
		}
	}
	option = {		# Resist these liberals!
		name = "flavor_spa.EVTOPTB3095"
		ai_chance = { factor = 25 }
		random_owned_province = {
			limit = {
				is_capital = no
				is_core = ROOT
			}
			spawn_rebels = {
				type = anti_tax_rebels
				size = 3
			}
		}
	}
}

# The Restoration of 1820
country_event = {
	id = flavor_spa.3096
	title = "flavor_spa.EVTNAME3096"
	desc = "flavor_spa.EVTDESC3096"
	picture = BATTLE_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_3096 }
		is_year = 1800
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		has_country_flag = SPA_had_event_3095
		NOT = { has_country_modifier = liberal_constitution }
	}

	mean_time_to_happen = {
		months = 300
	}

	immediate = {
		set_country_flag = SPA_had_event_3096
	}

	option = {		# Restore the liberal constitution
		name = "flavor_spa.EVTOPTA3096"
		ai_chance = { factor = 75 }
		add_country_modifier = {
			name = liberal_constitution
			duration = 3650
		}
	}
	option = {		# Resist these liberals!
		name = "flavor_spa.EVTOPTB3096"
		ai_chance = { factor = 25 }
		random_owned_province = {
			limit = {
				is_capital = no
				is_core = ROOT
			}
			spawn_rebels = {
				type = anti_tax_rebels
				size = 3
			}
		}
	}
}


########################################
# Minor Flavor Events                  #
########################################

# Miguel de Cervantes
country_event = {
	id = flavor_spa.1100
	title = "flavor_spa.EVTNAME1100"
	desc = "flavor_spa.EVTDESC1100"
	picture = ADVISOR_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_1100 }
		is_year = 1577
		NOT = { is_year = 1616 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
	}

	mean_time_to_happen = {
		months = 300
	}
	
	immediate = {
		set_country_flag = SPA_had_event_1100
	}

	option = {		# Excellent
		name = "EXCELLENT"
		add_adm_power = 10
		add_prestige = 10
	}
}

# Tomás Luis de Victoria
country_event = {
	id = flavor_spa.1101
	title = "flavor_spa.EVTNAME1101"
	desc = "flavor_spa.EVTDESC1101"
	picture = THEATRE_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_1101 }
		is_year = 1578
		NOT = { is_year = 1611 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
	}

	mean_time_to_happen = {
		months = 300
	}
	
	immediate = {
		set_country_flag = SPA_had_event_1101
	}

	option = {		# Excellent
		name = "EXCELLENT"
		add_adm_power = 10
		add_prestige = 10
	}
}


########################################
# Civil War in Castile
########################################

# Civil War in Castile
country_event = {
	id = flavor_spa.3557
	title = "flavor_spa.EVTNAME3557"
	desc = "flavor_spa.EVTDESC3557"
	picture = CIVIL_WAR_eventPicture

	trigger = {
		NOT = { has_country_flag = SPA_had_event_3557 }
		NOT = { is_year = 1500 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		is_at_war = no
		has_regency = yes
	}

	mean_time_to_happen = {
		months = 2000
		modifier = {
			factor = 0.95
			NOT = { stability = 2 }
		}
		modifier = {
			factor = 0.95
			NOT = { stability = 1 }
		}
		modifier = {
			factor = 0.75
			NOT = { stability = 0 }
		}
		modifier = {
			factor = 0.75
			NOT = { stability = -1 }
		}
		modifier = {
			factor = 0.75
			NOT = { stability = -2 }
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 3
		}
		modifier = {
			factor = 0.95
			war_exhaustion = 5
		}
		modifier = {
			factor = 0.75
			war_exhaustion = 10
		}
	}
	
	immediate = {
		set_country_flag = SPA_had_event_3557
	}
	
	option = {		# Support Álvaro de Luna
		name = "flavor_spa.EVTOPTA3557"
		ai_chance = { factor = 90 }
		set_country_flag = civil_war_in_castile
		add_stability = 1
		add_adm_power = 25
		define_advisor = {
			type = statesman
			name = "Álvaro de Luna"
			location = 217
			skill = 2
		}		
		random_owned_province = {
			limit = {
				is_core = ROOT
				is_capital = no
			}
			spawn_rebels = {
				type = noble_rebels
				size = 3
			}
		}
		hidden_effect = {
			if = {
				limit = {
					ARA = {
						is_subject = no
						NOT = { alliance_with = ROOT }
						NOT = { has_opinion = { who = ROOT value = 25 } }
						manpower = 10
					}
				}
				ARA = {
					country_event = { id = flavor_spa.3558 days = 10 }
				}
			}
			if = {
				limit = {
					NAV = {
						is_subject = no
						NOT = { alliance_with = ROOT }
						NOT = { has_opinion = { who = ROOT value = 25 } }
						manpower = 4
					}
				}
				NAV = {
					country_event = { id = flavor_spa.3558 days = 20 }
				}
			}
		}
	}
	option = {		# Support the sons of Ferdinand
		name = "flavor_spa.EVTOPTB3557"
		ai_chance = { factor = 10 }
		add_stability = -3
		add_country_modifier = {
			name = noble_influences
			duration = 7300
		}
	}
}

# Civil War in Castile
country_event = {
	id = flavor_spa.3558
	title = "flavor_spa.EVTNAME3558"
	desc = "flavor_spa.EVTDESC3558"
	picture = CIVIL_WAR_eventPicture

	is_triggered_only = yes
	
	option = {		# Support the Revolt
		name = "flavor_spa.EVTOPTA3558"
		ai_chance = { factor = 75 }
		if = {
			limit = {
				tag = ARA
			}
			add_manpower = -3
			FROM = {
				set_country_flag = civil_war_support_ARA
				country_event = { id = flavor_spa.3559 days = 20 tooltip = "flavor_spa.EVTTOOLTIP3558" }
			}
		}
		if = {
			limit = {
				tag = NAV
			}
			add_manpower = -1
			FROM = {
				set_country_flag = civil_war_support_NAV
				country_event = { id = flavor_spa.3559 days = 20 tooltip = "flavor_spa.EVTTOOLTIP3558" }
			}
		}
	}
	option = {		# We do not support rebels
		name = "flavor_spa.EVTOPTB3558"
		ai_chance = { factor = 25 }
		add_prestige = 10
	}
}

# Foreign Troops Intervene
country_event = {
	id = flavor_spa.3559
	title = "flavor_spa.EVTNAME3559"
	desc = "flavor_spa.EVTDESC3559"
	picture = MILITARY_CAMP_eventPicture

	is_triggered_only = yes
	
	option = {		# We will deal with them in time
		name = "flavor_spa.EVTOPTA3559"
		add_opinion = {
			who = FROM
			modifier = supported_rebels
		}
		if = {
			limit = {
				has_country_flag = civil_war_support_ARA
			}
			if = {
				limit = {
					any_neighbor_country = {
						tag = ARA
					}
				}
				random_owned_province = {
					limit = {
						is_capital = no
						any_neighbor_province = {
							owned_by = ARA
						}
					}
					spawn_rebels = {
						type = noble_rebels
						size = 3
						friend = ARA
					}
				}
			}
			if = {
				limit = {
					NOT = {
						any_neighbor_country = {
							tag = ARA
						}
					}
				}
				random_owned_province = {
					limit = {
						is_capital = no
					}
				}
				spawn_rebels = {
					type = noble_rebels
					size = 3
					friend = ARA
				}
			}
		}
		clr_country_flag = civil_war_support_ARA
		if = {
			limit = {
				has_country_flag = civil_war_support_NAV
			}
			if = {
				limit = {
					any_neighbor_country = {
						tag = NAV
					}
				}
				random_owned_province = {
					limit = {
						is_capital = no
						any_neighbor_province = {
							owned_by = NAV
						}
					}
					spawn_rebels = {
						type = noble_rebels
						size = 3
						friend = NAV
					}
				}
			}
			if = {
				limit = {
					NOT = {
						any_neighbor_country = {
							tag = NAV
						}
					}
				}
				random_owned_province = {
					limit = {
						is_capital = no
					}
				}
				spawn_rebels = {
					type = noble_rebels
					size = 1
					friend = NAV
				}
			}
		}
		clr_country_flag = civil_war_support_NAV
	}
}

# The Civil War Spreads to PROVINCE
province_event = {
	id = flavor_spa.3560
	title = "flavor_spa.EVTNAME3559"
	desc = "flavor_spa.EVTDESC3559"
	picture = CIVIL_WAR_eventPicture
	
	trigger = {
		owner = {
			NOT = { is_year = 1500 }
			OR = {
				AND = {
					tag = CAS
					NOT = { exists = SPA }
				}
				tag = SPA
			}
			had_country_flag = { flag = civil_war_in_castile days = 60 }
			num_of_revolts = 1
		}
		region = iberian_peninsula
		is_capital = no
		controlled_by = owner
		NOT = { has_province_flag = civil_war_spreads }
	}

	mean_time_to_happen = {
		months = 48
		modifier = {
			factor = 0.75
			owner = { NOT = { stability = 0 } }
		}
		modifier = {
			factor = 0.75
			owner = { NOT = { stability = -1 } }
		}
		modifier = {
			factor = 0.75
			owner = { NOT = { stability = -2 } }
		}
		modifier = {
			factor = 0.75
			owner = { war_exhaustion = 3 }
		}
		modifier = {
			factor = 0.75
			owner = { war_exhaustion = 5 }
		}
		modifier = {
			factor = 0.75
			owner = { war_exhaustion = 10 }
		}
		modifier = {
			factor = 0.95
			revolt_risk = 3
		}
		modifier = {
			factor = 0.95
			revolt_risk = 5
		}
		modifier = {
			factor = 0.95
			revolt_risk = 7
		}
		modifier = {
			factor = 0.75
			revolt_risk = 9
		}
		modifier = {
			factor = 0.75
			revolt_risk = 11
		}
	}
	
	immediate = {
		hidden_effect = {
			set_province_flag = civil_war_spreads
			random_list = {
				10 = { set_province_flag = revolt_3 }
				65 = { set_province_flag = revolt_2 }
				25 = { set_province_flag = revolt_1 }
			}
		}
	}
	
	option = {		# Where is the loyalty...
		name = "flavor_spa.EVTOPTA3559"
		if = {
			limit = {
				has_province_flag = revolt_3
			}
			spawn_rebels = {
				type = noble_rebels
				size = 3
			}
		}
		if = {
			limit = {
				has_province_flag = revolt_2
			}
			spawn_rebels = {
				type = noble_rebels
				size = 2
			}
		}
		if = {
			limit = {
				has_province_flag = revolt_1
			}
			spawn_rebels = {
				type = noble_rebels
				size = 1
			}
		}
		hidden_effect = {
			clr_province_flag = revolt_3
			clr_province_flag = revolt_2
			clr_province_flag = revolt_1
		}
	}
}


########################################
# The Italian Wars
########################################

# The Italian Wars
country_event = {
	id = flavor_spa.1007
	title = "flavor_spa.EVTNAME1007"
	desc = "flavor_spa.EVTDESC1007"
	picture = LAND_MILITARY_eventPicture
	
	trigger = {
		NOT = { has_country_flag = SPA_had_event_1007 }
		is_year = 1490
		NOT = { is_year = 1590 }
		OR = {
			AND = {
				tag = CAS
				NOT = { exists = SPA }
			}
			tag = SPA
		}
		NOT = { alliance_with = FRA }
		NOT = { is_subject_of = FRA }
		NOT = { war_with = FRA }
		italian_region = {
			owned_by = ROOT
		}
		italian_region = {
			owned_by = FRA
		}
	}

	mean_time_to_happen = {
		months = 2000
		modifier = {
			factor = 0.95
			FRA = {
				num_of_owned_provinces_with = {
					value = 2
					region = italian_region
				}
			}
		}
		modifier = {
			factor = 0.95
			FRA = {
				num_of_owned_provinces_with = {
					value = 4
					region = italian_region
				}
			}
		}
		modifier = {
			factor = 0.95
			FRA = {
				num_of_owned_provinces_with = {
					value = 6
					region = italian_region
				}
			}
		}
		modifier = {
			factor = 0.95
			num_of_owned_provinces_with = {
				value = 2
				region = italian_region
			}
		}
		modifier = {
			factor = 0.95
			num_of_owned_provinces_with = {
				value = 4
				region = italian_region
			}
		}
		modifier = {
			factor = 0.95
			num_of_owned_provinces_with = {
				value = 6
				region = italian_region
			}
		}
	}
	
	immediate = {
		set_country_flag = SPA_had_event_1007
	}

	option = {		# Claim all French land in Italy!
		name = "flavor_spa.EVTOPTA1007"
		ai_chance = { factor = 90 }
		FRA = {
			add_opinion = {
				who = ROOT
				modifier = claimed_italy
			}
			every_owned_province = {
				limit = {
					region = italian_region
				}
				add_claim = ROOT
			}
			hidden_effect = {
				country_event = { id = flavor_spa.1008 days = 10 }
			}
		}
	}
	option = {		# Italy lies outside our sphere of interest
		name = "flavor_spa.EVTOPTB1007"
		ai_chance = { factor = 10 }
		add_prestige = -10
	}
}

# The Italian Wars
country_event = {
	id = flavor_spa.1008
	title = "flavor_spa.EVTNAME1008"
	desc = "flavor_spa.EVTDESC1008"
	picture = MILITARY_CAMP_eventPicture
	
	is_triggered_only = yes
	
	option = {		# Then counter-claim all ADJECTIVE provinces!
		name = "flavor_spa.EVTOPTA1008"
		ai_chance = { factor = 90 }
		FROM = {
			every_owned_province = {
				limit = {
					region = italian_region
				}
				add_claim = ROOT
			}
			hidden_effect = {
				country_event = { id = flavor_spa.1009 days = 10 }
			}
		}
	}
	option = {		# We should back down in Italy
		name = "flavor_spa.EVTOPTB1008"
		ai_chance = { factor = 10 }
		add_prestige = -10
	}
}

# The Italian Wars
country_event = {
	id = flavor_spa.1009
	title = "flavor_spa.EVTNAME1009"
	desc = "flavor_spa.EVTDESC1009"
	picture = MILITARY_CAMP_eventPicture
	
	is_triggered_only = yes
	
	option = {		# How dare they?! Italy is ours!
		name = "flavor_spa.EVTOPTA1009"
		add_opinion = {
			who = FROM
			modifier = claimed_italy
		}
	}
}
